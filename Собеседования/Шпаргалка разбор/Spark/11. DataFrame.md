DataFrame — это высокоуровневая структура данных в Spark, аналогичная таблицам в реляционных базах данных или DataFrame в Pandas.

- **Структура:**  
    Содержит строки и столбцы, где каждый столбец имеет имя и тип данных.
- **Преимущества:**
    - Удобен для обработки структурированных данных.
    - Оптимизирован с помощью Catalyst Optimizer.
    - Поддерживает интеграцию с SQL.

---

#### **2. Основные операции с DataFrame**

|**Операция**|**Описание**|**Пример**|
|---|---|---|
|**`select`**|Выборка столбцов.|`df.select("col1", "col2").show()`|
|**`filter`**|Фильтрация строк.|`df.filter(df["age"] > 30).show()`|
|**`groupBy`**|Группировка данных.|`df.groupBy("department").count().show()`|
|**`withColumn`**|Создание нового столбца.|`df.withColumn("new_col", df["age"] + 5).show()`|
|**`orderBy`**|Сортировка строк.|`df.orderBy("age", ascending=False).show()`|
|**`join`**|Объединение двух DataFrame.|`df1.join(df2, df1["id"] == df2["id"], "inner").show()`|

---

#### **3. SQL в Spark**

Spark позволяет писать SQL-запросы прямо в коде.

**Пример:**

1. Зарегистрируем DataFrame как временную таблицу:
    
    `df.createOrReplaceTempView("people")`
    
2. Выполним SQL-запрос:
    
    `result = spark.sql("SELECT * FROM people WHERE age > 30") result.show()`