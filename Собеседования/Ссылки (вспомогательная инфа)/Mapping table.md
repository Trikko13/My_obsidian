**Таблица сопоставления** (в оригинале — **mapping table**) в Greenplum и PostgreSQL — это структура, которая используется для управления памятью, и, в частности, для связи между страницами данных в памяти и их физическим местоположением на диске. Она позволяет системе эффективно находить данные, минимизируя количество обращений к диску, что особенно важно в условиях MPP-архитектуры Greenplum.

### Зачем нужна таблица сопоставления?

Когда данные запрашиваются в Greenplum:

- Они сначала считываются из буферной области в памяти (shared buffer), если они уже закэшированы там.
- Если данных нет в буфере, они считываются с диска и временно помещаются в shared buffer.

Таблица сопоставления помогает быстро определять, находятся ли нужные страницы данных в памяти, или их необходимо загрузить с диска.

### Пример работы таблицы сопоставления:

Предположим, Greenplum должен выполнить запрос к таблице `sales`. Запрашиваемая информация может уже находиться в буфере, или ее нужно будет подгрузить с диска:

1. **Поиск в таблице сопоставления**: Сначала система проверяет таблицу сопоставления, чтобы увидеть, находятся ли страницы с данными `sales` в памяти. Если да, она может сразу отправить данные процессу, обрабатывающему запрос, минуя чтение с диска.
    
2. **Чтение с диска при необходимости**: Если данных нет в памяти, таблица сопоставления указывает, где именно на диске расположены нужные страницы. Система загружает их с диска и размещает в буферной области памяти.
    
3. **Обновление таблицы сопоставления**: Если данные были загружены с диска, таблица сопоставления обновляется, чтобы указывать на новое расположение страниц в памяти.
    

### Важность таблицы сопоставления в Greenplum

В Greenplum, как и в PostgreSQL, эта структура помогает эффективно управлять данными в памяти и избегать лишних обращений к диску. Это критично для распределённых систем, таких как Greenplum, где чтение с диска на разных узлах может быть дорогой операцией.

### Итог

Таблица сопоставления — это своего рода "карта", которая связывает страницы данных на диске с их копиями в памяти. Она позволяет быстро находить данные, которые уже находятся в shared buffer, или определять, откуда на диске их нужно загрузить.