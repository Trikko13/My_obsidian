### **Способы хранения DataFrame с помощью `.persist()`**

**Основные уровни хранения (Storage Levels):**

| Уровень хранения        | Где данные хранятся                                              | Когда использовать                                                                |
| ----------------------- | ---------------------------------------------------------------- | --------------------------------------------------------------------------------- |
| **MEMORY_ONLY**         | Только в памяти. Если памяти не хватает, данные пересчитываются. | Когда операции быстрой и данные умещаются в памяти.                               |
| **MEMORY_AND_DISK**     | В памяти, а при нехватке памяти — на диск.                       | Когда данные не помещаются полностью в память.                                    |
| **DISK_ONLY**           | Только на диск.                                                  | Когда памяти совсем нет, а пересчитывать данные слишком дорого.                   |
| **MEMORY_ONLY_SER**     | Только в памяти, с использованием сериализации (сжатия).         | Когда данных много, и их нужно уместить в память, даже с компромиссной скоростью. |
| **MEMORY_AND_DISK_SER** | Память + диск, данные сериализуются.                             | Когда данных слишком много для несериализованного хранения.                       |
### **Практическое использование**

1. Используй **`.cache()`**, если уверен, что данные помещаются в память. Это быстрее.
2. Используй **`.persist()`**, если данные:
    - **Не помещаются в память.**
    - **Дорого пересчитывать.**

**Пример:**  
Если данные требуют дорогостоящих операций (например, shuffle), **`.persist(MEMORY_AND_DISK)`** — отличный выбор, чтобы предотвратить потерю прогресса.
### **Сравнение `.cache()` и `.persist()`**

|**Метод**|**Хранение**|**Гибкость**|**Производительность**|
|---|---|---|---|
|`.cache()`|Только память (Memory Only).|Нет, фиксированный уровень.|Быстро, если памяти достаточно.|
|`.persist()`|Память + диск (и другие варианты).|Гибкость выбора уровня.|Может быть медленнее, если используется диск.|
